<!-- General Open Graph Metadata -->
{{/* Resolve best image for OG: params.images[0] > cover.image > site fallback; handle page-bundle relative paths */}}
{{ $img := "" }}
{{ with .Params.images }}{{ if gt (len .) 0 }}{{ $first := index . 0 }}{{ if ne $first "" }}{{ $img = $first }}{{ end }}{{ end }}{{ end }}
{{ if and (eq $img "") .Params.cover.image }}{{ $img = .Params.cover.image }}{{ end }}
{{ if and (eq $img "") (site.Params.opengraph.image) }}{{ $img = site.Params.opengraph.image }}{{ end }}
{{ $og := "" }}
{{ if $img }}
  {{ $s := printf "%v" $img }}
  {{ if or (hasPrefix $s "http://") (hasPrefix $s "https://") }}
    {{ $og = $s }}
  {{ else if hasPrefix $s "/" }}
    {{ $og = (absURL $s) }}
  {{ else }}
    {{ if .Params.cover.relative }}
      {{ $og = printf "%s%s" .Permalink (strings.TrimPrefix "/" $s) }}
    {{ else }}
      {{ with .Page.Resources.GetMatch $s }}
        {{ $og = .Permalink }}
      {{ else }}
        {{ $og = (absURL $s) }}
      {{ end }}
    {{ end }}
  {{ end }}
{{ end }}
{{ if eq $og "" }}{{ $og = ("/Pradeep-Loganathan.jpeg" | absURL) }}{{ end }}

<meta property="og:url" content="{{ .Permalink }}" />
<meta property="og:site_name" content="{{ site.Title }}" />
<meta property="og:title" content="{{ .Title }}" />
<meta property="og:description" content="{{ .Description | default .Summary }}" />
<meta property="og:image" content="{{ $og }}" />
<meta property="og:image:secure_url" content="{{ $og | replaceRE "^http:" "https:" }}" />
{{ $alt := (or .Params.cover.alt .Title) }}
<meta property="og:image:alt" content="{{ $alt }}" />

<!-- Detect Type: Book, Blog, or Website -->
{{ if eq .Section "books" }}
    <meta property="og:type" content="book" />
    <meta property="book:author" content="{{ .Params.author | default "Pradeep Loganathan" }}">
    {{ with .Params.isbn }}<meta property="book:isbn" content="{{ . }}" />{{ end }}
    {{ with .Params.release_date }}<meta property="book:release_date" content="{{ . }}" />{{ end }}
    {{ range .Params.tags }}
    <meta property="book:tag" content="{{ . }}" />
    {{ end }}

{{ else if or .IsPage (eq .Section "blog") }}
    <meta property="og:type" content="article" />
    {{ with .Params.author }}<meta property="article:author" content="{{ . }}" />{{ end }}
    {{ with .PublishDate }}<meta property="article:published_time" content="{{ .Format `2006-01-02T15:04:05Z07:00` }}" />{{ end }}
    {{ with .Lastmod }}<meta property="article:modified_time" content="{{ .Format `2006-01-02T15:04:05Z07:00` }}" />{{ end }}
    {{- range .GetTerms "tags" | first 6 }}
        <meta property="article:tag" content="{{ .Page.Title | plainify }}">
    {{- end }}

{{ else }}
    <meta property="og:type" content="website" />
{{ end }}

<!-- Twitter Card Metadata -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ .Title }}">
<meta name="twitter:description" content="{{ .Description | default .Summary }}">
<meta name="twitter:image" content="{{ $og }}">
<meta name="twitter:image:src" content="{{ $og }}">
<meta name="twitter:image:alt" content="{{ $alt }}">

{{/* Optional: Facebook App ID if provided */}}
{{ with site.Params.facebookAppID }}
<meta property="fb:app_id" content="{{ . }}">
{{ end }}
<meta name="twitter:site" content="@pradeepl">
